@model SearchViewModel

<a class="back-link" href="@Url.Action("Index", "Home")">
    <i class="fa-solid fa-backward"></i> Back
</a>

<div class="filtering">
    <i class="fa-solid fa-filter"></i>

    <!-- Färgalternativ med cirklar -->
    <div class="color-options">
        <input type="radio" name="color" id="red" value="Red" class="color-op" />
        <label for="red" class="color-label red"></label>

        <input type="radio" name="color" id="blue" value="Blue" class="color-op" />
        <label for="blue" class="color-label blue"></label>

        <input type="radio" name="color" id="green" value="Green" class="color-op" />
        <label for="green" class="color-label green"></label>

        <input type="radio" name="color" id="yellow" value="Yellow" class="color-op" />
        <label for="yellow" class="color-label yellow"></label>

        <input type="radio" name="color" id="white" value="White" class="color-op" />
        <label for="white" class="color-label white"></label>

        <input type="radio" name="color" id="black" value="Black" class="color-op" />
        <label for="black" class="color-label black"></label>
        <!-- Lägg till fler färgalternativ efter behov -->


    </div>
    <label for="primaryCategory">Primary Category:</label>
    <select id="primaryCategory" class="primary-category">
        <option value="">All</option>
        <option value="Men">Men</option>
        <option value="Women">Women</option>
        <option value="Unisex">Unisex</option>
        <!-- Lägg till fler primära kategorier efter behov -->
    </select>
    <label for="priceRange">Price Range: $<span id="priceValues">0 - 1000</span></label>
    <input type="range" id="priceSlider" min="0" max="1000" value="0" step="1">


    <label for="subCategory">Subcategory:</label>
    <select id="subCategory" class="sub-category">
        <option value="">All</option>
        @foreach (var subCategory in new[] {
        "T-Shirts Men", "T-Shirts Women", "T-Shirts Unisex",
        "Pants Men", "Pants Women", "Pants Unisex","Dresses",
        "Shoes Men", "Shoes Women", "Shoes Unisex",
        "Bags Men", "Bags Women", "Bags Unisex","Suits",
        "Accessories Men", "Accessories Women", "Accessories Unisex"
        })
        {
            <option value="@subCategory">@subCategory</option>
        }
    </select>


  
   
</div>

<section id="filteredResults" class="product-section">
   
      <div class="container product-container">
    <div class="container product-container-items">
      
        @foreach (var product in Model.Results)
        {
            <partial name="_ProductTilePartial" model="product" />
        }
    </div>
      </div>
</section>

@section scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Sparade värden för färg, pris och subkategori
            var selectedColor = null;
            var selectedMinPrice = 0;
            var selectedMaxPrice = 1000;
            var selectedSubCategory = null;

            // Färgfiltrering
            var colorOps = document.querySelectorAll('.color-op');
            colorOps.forEach(function (colorOp) {
                colorOp.addEventListener('click', function () {
                    selectedColor = this.value;
                    filterProducts(selectedColor, selectedMinPrice, selectedMaxPrice, selectedSubCategory);
                });
            });

            // Prisfiltrering med reglage
            var priceSlider = document.getElementById('priceSlider');
            var priceValues = document.getElementById('priceValues');
            priceSlider.addEventListener('input', function () {
                selectedMinPrice = this.value;
                priceValues.textContent = selectedMinPrice + " - " + selectedMaxPrice;
                filterProducts(selectedColor, selectedMinPrice, selectedMaxPrice, selectedSubCategory);
            });

            // Subkategorifiltrering
            var subCategoryDropdown = document.getElementById('subCategory');
            subCategoryDropdown.addEventListener('change', function () {
                selectedSubCategory = this.value;
                filterProducts(selectedColor, selectedMinPrice, selectedMaxPrice, selectedSubCategory);
            });

            // JavaScript för att göra sidan om när "Refresh" knappen klickas på
            var refreshButton = document.getElementById('refreshButton');
            refreshButton.addEventListener('click', function () {
                location.reload();
            });

            function filterProducts(color, minPrice, maxPrice, subCategory) {
                var colorValue = color || null;
                var minPriceValue = minPrice || 0;
                var maxPriceValue = maxPrice || 1000;
                var subCategoryValue = subCategory || null;

                // Gör ett AJAX-anrop för att hämta de uppdaterade resultaten
                $.ajax({
                    url: '@Url.Action("Filter", "Products")',
                    type: 'GET',
                    data: { color: colorValue, minPrice: minPriceValue, maxPrice: maxPriceValue, subCategory: subCategoryValue },
                    success: function (result) {
                        // Uppdatera endast innehållet i product-container-items
                        $('#filteredResults .product-container-items').html($(result).find('.product-container-items').html());
                    },
                    error: function () {
                        console.error('Error in AJAX request');
                    }
                });
            }
        });
    </script>
}
